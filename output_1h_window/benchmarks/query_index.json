{
  "metadata": {
    "phase": "Phase 2: Query Generation",
    "total_queries": 42,
    "total_metrics": 21,
    "original_metrics": 12,
    "additional_patterns": 9,
    "dimensions": [
      "deviceCategory",
      "countryIso",
      "platform"
    ],
    "old_schema_table": "default.eco_cross_page_flow_pt1m_local_20251008_3cust",
    "new_schema_table": "default.rui_eco_cross_page_preagg_pt1m_1h",
    "unified_date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
  },
  "queries": [
    {
      "metric_number": 1,
      "query_type": "aggregation",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "f_8458_9478_success",
      "flowid": "f_8458_9478",
      "source_map_column": "metricIntGroup2",
      "target_physical_column": "int49",
      "old_schema_query_file": "old_schema_1960181009_f_8458_9478_success.sql",
      "new_schema_query_file": "new_schema_1960181009_f_8458_9478_success.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 2,
      "query_type": "aggregation",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "f_8458_9478_total_duration",
      "flowid": "f_8458_9478",
      "source_map_column": "metricIntGroup2",
      "target_physical_column": "int50",
      "old_schema_query_file": "old_schema_1960181009_f_8458_9478_total_duration.sql",
      "new_schema_query_file": "new_schema_1960181009_f_8458_9478_total_duration.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 3,
      "query_type": "aggregation",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "app_startup_time",
      "flowid": "app_startup",
      "source_map_column": "metricIntGroup13",
      "target_physical_column": "int21",
      "old_schema_query_file": "old_schema_1960181009_app_startup_time.sql",
      "new_schema_query_file": "new_schema_1960181009_app_startup_time.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 4,
      "query_type": "aggregation",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "event_count",
      "flowid": "session",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int22",
      "old_schema_query_file": "old_schema_1960181009_event_count.sql",
      "new_schema_query_file": "new_schema_1960181009_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 5,
      "query_type": "aggregation",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "f_202_363_success",
      "flowid": "f_202_363",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int25",
      "old_schema_query_file": "old_schema_1960181845_f_202_363_success.sql",
      "new_schema_query_file": "new_schema_1960181845_f_202_363_success.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 6,
      "query_type": "aggregation",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "f_202_363_total_duration",
      "flowid": "f_202_363",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int26",
      "old_schema_query_file": "old_schema_1960181845_f_202_363_total_duration.sql",
      "new_schema_query_file": "new_schema_1960181845_f_202_363_total_duration.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 7,
      "query_type": "aggregation",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "app_startup_time",
      "flowid": "app_startup",
      "source_map_column": "metricIntGroup13",
      "target_physical_column": "int16",
      "old_schema_query_file": "old_schema_1960181845_app_startup_time.sql",
      "new_schema_query_file": "new_schema_1960181845_app_startup_time.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 8,
      "query_type": "aggregation",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "event_count",
      "flowid": "session",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int18",
      "old_schema_query_file": "old_schema_1960181845_event_count.sql",
      "new_schema_query_file": "new_schema_1960181845_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 9,
      "query_type": "aggregation",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "f_183_7200_success",
      "flowid": "f_183_7200",
      "source_map_column": "metricIntGroup14",
      "target_physical_column": "int112",
      "old_schema_query_file": "old_schema_1960183305_f_183_7200_success.sql",
      "new_schema_query_file": "new_schema_1960183305_f_183_7200_success.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 10,
      "query_type": "aggregation",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "f_183_7200_total_duration",
      "flowid": "f_183_7200",
      "source_map_column": "metricIntGroup14",
      "target_physical_column": "int113",
      "old_schema_query_file": "old_schema_1960183305_f_183_7200_total_duration.sql",
      "new_schema_query_file": "new_schema_1960183305_f_183_7200_total_duration.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 11,
      "query_type": "aggregation",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "app_startup_time",
      "flowid": "app_startup",
      "source_map_column": "metricIntGroup13",
      "target_physical_column": "int95",
      "old_schema_query_file": "old_schema_1960183305_app_startup_time.sql",
      "new_schema_query_file": "new_schema_1960183305_app_startup_time.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 12,
      "query_type": "aggregation",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "event_count",
      "flowid": "session",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int97",
      "old_schema_query_file": "old_schema_1960183305_event_count.sql",
      "new_schema_query_file": "new_schema_1960183305_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 13,
      "query_type": "groupby_country",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int22",
      "old_schema_query_file": "groupby_country_old_schema_1960181009_event_count.sql",
      "new_schema_query_file": "groupby_country_new_schema_1960181009_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 14,
      "query_type": "groupby_minute",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int22",
      "old_schema_query_file": "groupby_minute_old_schema_1960181009_event_count.sql",
      "new_schema_query_file": "groupby_minute_new_schema_1960181009_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 15,
      "query_type": "groupby_minute_filtered",
      "customer_id": 1960181009,
      "customer_name": "Intigral",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int22",
      "old_schema_query_file": "groupby_minute_filtered_old_schema_1960181009_event_count.sql",
      "new_schema_query_file": "groupby_minute_filtered_new_schema_1960181009_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 16,
      "query_type": "groupby_country",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int18",
      "old_schema_query_file": "groupby_country_old_schema_1960181845_event_count.sql",
      "new_schema_query_file": "groupby_country_new_schema_1960181845_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 17,
      "query_type": "groupby_minute",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int18",
      "old_schema_query_file": "groupby_minute_old_schema_1960181845_event_count.sql",
      "new_schema_query_file": "groupby_minute_new_schema_1960181845_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 18,
      "query_type": "groupby_minute_filtered",
      "customer_id": 1960181845,
      "customer_name": "SlingTV",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int18",
      "old_schema_query_file": "groupby_minute_filtered_old_schema_1960181845_event_count.sql",
      "new_schema_query_file": "groupby_minute_filtered_new_schema_1960181845_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 19,
      "query_type": "groupby_country",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int97",
      "old_schema_query_file": "groupby_country_old_schema_1960183305_event_count.sql",
      "new_schema_query_file": "groupby_country_new_schema_1960183305_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 20,
      "query_type": "groupby_minute",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int97",
      "old_schema_query_file": "groupby_minute_old_schema_1960183305_event_count.sql",
      "new_schema_query_file": "groupby_minute_new_schema_1960183305_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    },
    {
      "metric_number": 21,
      "query_type": "groupby_minute_filtered",
      "customer_id": 1960183305,
      "customer_name": "NFL",
      "metric_key": "event_count",
      "flowid": "ALL",
      "source_map_column": "metricIntGroup15",
      "target_physical_column": "int97",
      "old_schema_query_file": "groupby_minute_filtered_old_schema_1960183305_event_count.sql",
      "new_schema_query_file": "groupby_minute_filtered_new_schema_1960183305_event_count.sql",
      "date_range": "2025-10-08 00:00:00 to 2025-10-08 06:00:00"
    }
  ]
}